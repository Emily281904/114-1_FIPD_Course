// 2. Code for Part E.1: Color Cycle + Hold to Turn Off

const int BUTTON_PIN = 2; 
const int RED_PIN = 9;    
const int GREEN_PIN = 10; 
const int BLUE_PIN = 11;  

// Colors for the cycle: Green, Yellow, Red
const int COLORS[3][3] = { 
  {0, 255, 0},     
  {255, 200, 0},   
  {255, 0, 0}      
};

unsigned long previousMillis = 0;
const long interval = 2000; // 2 seconds
int currentColorIndex = 0;

// Helper function for Common Anode: 0=ON, 255=OFF
void setLED(int R, int G, int B) {
  analogWrite(RED_PIN, 255 - R);
  analogWrite(GREEN_PIN, 255 - G);
  analogWrite(BLUE_PIN, 255 - B);
}

void setup() {
  pinMode(RED_PIN, OUTPUT);
  pinMode(GREEN_PIN, OUTPUT);
  pinMode(BLUE_PIN, OUTPUT);
  pinMode(BUTTON_PIN, INPUT); 
  setLED(0, 0, 0); 
  previousMillis = millis();
}

void loop() {
  int buttonState = digitalRead(BUTTON_PIN);
  
  if (buttonState == LOW) { 
    // E.1 Requirement: If the button is held, the LED turns OFF.
    setLED(0, 0, 0); 
    // Timer does not update while held.
  } else { 
    // E.1 Requirement: If released, resume cycling.
    
    unsigned long currentMillis = millis();

    if (currentMillis - previousMillis >= interval) {
      previousMillis = currentMillis; // Update timer

      currentColorIndex = (currentColorIndex + 1) % 3; // Advance to the next color
      
      int R = COLORS[currentColorIndex][0];
      int G = COLORS[currentColorIndex][1];
      int B = COLORS[currentColorIndex][2];
      
      setLED(R, G, B);
    }
  }
}
